---
meta:
  - title: 為什麼我推 TypeScript
  - name: description
    content: 探討 JavaScript 是否是沒有型別的語言，變量沒有型別限制會有什麼問題，型別限制的好處是什麼，為什麼我推 TypeScript
  - name: keywords
    content: typescript, javascript, type
  - name: og:image
    content: https://images.unsplash.com/photo-1482517967863-00e15c9b44be

published: 2023-12-24
---

# {frontmatter.meta[0].title}

![Photo by picsum](https://images.unsplash.com/photo-1482517967863-00e15c9b44be)

## JavaScript 是沒有型別的語言嗎？

JavaScript 是有型別的，  
應該說，任何高階程式語言都有型別，  
不同的型別可以用來區分資料的用途跟行為，  
像是 `string` 跟 `number` 是兩種不同的型別，  
`string` 用來表示純文字，`number` 用來表示數字，  
它們針對同樣的動作 (operation) 產生的對應行為也不同。

例如.

```js
console.log(1 + 1);  // => 2
console.log('1' + '1'); // => '11'
```

再來對照 Java。

```java
System.out.println(1 + 1); // => 2
System.out.println("1" + "1"); // => "11"
```

兩邊對於數值 (value) 與其型別的差異並不大。

接下來，我們來看真正的差異所在。  

以下，我們先宣告 (declare) 變量 `a`，但不初始化其變量 (initialize)。

```js
let a;
a = 1;
a = '1';
```

以上範例可以看出，  
變量 `a` 先被賦予了 `number` 型別，  
之後又被換成了 `string` 型別。

```java
String a;
a = 1; // Incompatible types: int cannot be converted to java.lang.String
a = "1";
```

對照組可以看到，  
變量 `a` 一開始就被 **限制** 了可以賦予的型別，  
所以當之後想要賦予 `a` `number` 型別時，  
編譯器 (Compiler) 會拋出錯誤來 **阻止開發者撰寫不合理的程式碼**。

另一個例子，用 Java 的 `var` 來推斷 (inference) `a` 的型別，

```java
var a; // Error: Cannot infer type for local variable a   (cannot use 'var' on variable without initializer)
a = "1";
```

即便是 `var`，Java 還是要求在宣告的當下就要提供型別來 **限制**。

再來讓我們看看宣告當下就初始化數值 (initialize) 的範例。

```java
var a = "1";
a = 1; // Incompatible types: int cannot be converted to java.lang.String
```

在上面的範例中，變量 `a` 宣告的當下就被賦予了數值以及其數值的型別 `String`，  
所以當之後想要賦予 `a` `number` 型別時，編譯器 (Compiler) 會拋出錯誤。

下面是 JavaScript 的範例，

```js
let a = '1';
a = 1;
```

可以看到 JavaScript 並沒有阻止我們賦予變量 `a` 不同的型別。

以上我歸納出的差異並非是 **沒有型別**，  
而是 **宣告的變量沒有型別限制**。

## 變量沒有型別的限制有什麼問題嗎？

我個人的結論是 沒什麼問題。

不只是 JavaScript 很多的語言都是這個特性，像是 Python, Ruby, PHP, Elixir。  
對於熟悉語言特性的開發者來說，  
照樣可以開發出能力強大的應用程式，  
這世界上成千上百的大小公司使用這類語言來開發他們的服務，  
根本不成問題。

所以我認為要關注命題不是 變量沒有型別的限制會有什麼問題，  
而是 加上變量的型別限制 有什麼好處。

## 加上變量的型別限制 有什麼好處？

以下分享一些實際遇過的情況。

### 透過編譯器 (Compiler) 來預防開發者犯低級錯誤

它可以防止像是打錯字，或是拋錯資料型別等低級錯誤。

我是一個常犯低級錯誤且個性很散仙的工程師，  
常常看動畫漫畫到凌晨，導致隔天腦子不清楚。

透過程式來防止我犯蠢，讓我即便在狀況不好的情況，  
撰寫的程式依然可以維持一定的品質。

### 異動時的保障

如果我們能夠透過一個 command 來抓出低級錯誤，這會降低犯錯以及除錯的成本。

程式異動必然伴隨著出錯的風險。  
程式異動包含 增加功能，除錯，重構。

無論是小型或是大型的異動，  
我們都要保證應用程式的運作符合預期。

但我們很難每次做異動都用人力去逐一檢查，  
當檢查的範圍越大，它需要的人力跟時間都會越來越大，  
更何況是人類就會偷懶。

這就是為什麼我們需要設計自動化檢查來減少人工的成本，  
而自動化檢查也包含了 靜態程式分析。  
透過 靜態程式分析 可以排除一些錯誤，而不需要實際運行程式，  
靜態程式分析 其中也包含 靜態型別檢查。

多項檢查通過會提供產品方跟用戶雙方足夠的信心，  
就如同食物需要過安全標章一樣的道理。

### 資料標準化

逐漸擴大並逐漸複雜化是大多程式需要面對的過程。

> 這邊用 **大多** 是因為 不一定程式會經歷擴大跟複雜化，  
> 有些程式像是 unix 的 `cd` 或是 `ls`，  
> 它至今依然被廣泛使用但既不大也不複雜。

當應用程式複雜到一個程度，  
我們是很難單從變量本身看出它到底會是什麼類型的資料，  
更何況變量可能會在中途被賦予非預期的資料型別。

讓宣告的變量擁有型別限制，可以保證該變量一定是某種資料型別，  
這可以提供開發者更大的信心來操作該型別，  
並讓系統分析人員能夠更快釐清資料的脈絡。

### 將型別視作規格的一部分

當我們在定義 API 時 (這邊指的是廣義的 API ，包含 function, library, sdk, service)，  
清楚定義 input 跟 output 的資料型別為何，  
可以有效降低來回溝通的成本。

當然，這並不表示有了型別就可以不用文件跟說明，  
是指定義型別可以更精準的告知使用者要如何使用這段程式。

## 什麼情況不推薦使用 TypeScript

先說什麼情況不推薦使用 TypeScript 。

### 應用程式的規模不大，複雜度不高

1. 以靜態資訊為主的網站
1. 一次性的自動化腳本

### 產品週期過短

1. 時效性活動網站
1. 廣告

### 對 JavaScript 沒有足夠的了解

我必須強調 TypeScript 只是 JavaScript + Type，  
如果對 JavaScript 的基本知識不足，  
用 TypeScript 也不會有任何幫助。

並不會因為工程師是從 Java, C# 等靜態型別語言跳過來，  
就會比較熟悉 TypeScript，  
如果沒有足夠理解 JavaScript 本身的特性，  
那還是會被雷到，然後怪罪語言太爛，  
這像是沒看特斯拉煞車說明書跑去開車出車禍，怪車子做的爛。

## 什麼情況推薦使用 TypeScript

### 需要開發或維護的專案數目大於 1

我的記憶力很差，  
大概同時間只能記得一個專案的大致情況，  
所以如果沒有型別來輔助，  
我就需要花費大量時間追朔資料是什麼，  
函式的目的是什麼，input 跟 output 是什麼。

### 複雜的資料操作邏輯

資料包含 Server State 跟 Client State，  
如果應用程式需要做資料操作，像是 搜尋，過濾，修改，  
這些情況都很容易隨著專案發展越來愈複雜。

如果沒有型別，我們需要從頭思考跟記憶資料的來源以及變化，  
而透過標註型別可以有效減少我們需要思考跟記憶的範圍，  
我們只需要關注當前函式下的 input 跟 output 型別即可。

### 團隊成員大於 1

只要團隊成員不是只有自己，則必然存在溝通成本。

透過直接在程式碼上的型別標註，  
可以減少成員額外花在溝通 資料是什麼，傳什麼 的時間。

### 產品週期大於 一個季度

產品週期大於一個季度，  
表示它有機會被不同於開發它的人維護，  
型別標註可以減少新進專案的人員釐清資料流程時間，  
型別檢查也可以預防程式異動時可能會犯的低級錯誤。

