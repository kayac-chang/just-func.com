---
meta:
  - title: äº†è§£ Base64
  - name: description
    content: äº†è§£ Base64 åˆ°åº•æ˜¯ä»€éº¼ï¼Œå®ƒçš„åŸç†ï¼Œä»¥åŠå®ƒåœ¨ JavaScript ä¸­å¦‚ä½•æ‡‰ç”¨
  - name: keywords
    content: base64, javascript, encode, decode

published: 2023-01-18
---

# äº†è§£ Base64

![Photo by picsum](https://images.unsplash.com/photo-1578048421563-9aa187e12baf)

åœ¨äº†è§£ `base64` ä¹‹å‰ï¼Œæˆ‘å€‘å…ˆä¾†äº†è§£ä¸€ä¸‹ç·¨ç¢¼æ˜¯ä»€éº¼ã€‚

## ç·¨ç¢¼æ˜¯ä»€éº¼ï¼Ÿ

**ç·¨ç¢¼**æ˜¯å°‡ä¸€ç¨®å°‡è³‡æ–™**è½‰æ›**æˆå¦ä¸€ç¨®è³‡æ–™çš„éç¨‹ï¼Œ
è€Œé€™å€‹éç¨‹æ˜¯å¯ä»¥è¢«**åè½‰**çš„ã€‚

èˆ‰å€‹ä¾‹å­ï¼Œ
æˆ‘å€‘å¯ä»¥é€éä¸€å¼µ**å­—æ¯å°æ‡‰è¡¨**ï¼Œå°‡ä¸€ä¸²è‹±æ–‡å­—è½‰æ›æˆä¸€ä¸²æ•¸å­—ã€‚

å­—æ¯å°æ‡‰è¡¨ï¼š

```text
a b c d e f g h i j k l m n o p q r s t u v w x y z
1 2 3 4 5 6 7 8 9 10 11 12 13 14 ... 26
```

é€™æ¨£æˆ‘å€‘å°±å¯ä»¥å°‡ `hello` è½‰æ›æˆ `8 5 12 12 15`ï¼Œ
è€Œé€™å€‹éç¨‹æ˜¯å¯ä»¥è¢«åè½‰çš„ï¼Œä¹Ÿå°±æ˜¯èªªæˆ‘å€‘å¯ä»¥é€éé€™å¼µå­—æ¯å°æ‡‰è¡¨ï¼Œ
å°‡ `8 5 12 12 15` è½‰æ›å› `hello`ã€‚

é€™å€‹è½‰æ›çš„éç¨‹å°±æ˜¯ç·¨ç¢¼ï¼Œè€Œé€™å¼µå­—æ¯å°æ‡‰è¡¨å°±æ˜¯é€™å€‹è½‰æ›çš„è¦å‰‡ã€‚

ä¸¦ä¸”å¾ `hello` è½‰æ›æˆ `8 5 12 12 15` çš„éç¨‹ï¼Œæˆ‘å€‘ç¨±ä¹‹ç‚º **encode**ï¼Œ
è€Œå¾ `8 5 12 12 15` è½‰æ›å› `hello` çš„éç¨‹ï¼Œæˆ‘å€‘ç¨±ä¹‹ç‚º **decode**ã€‚

å¸¸è¦‹çš„ç·¨ç¢¼æ–¹å¼æœ‰ `base64`ã€`hex`ã€`binary`ã€`ascii` ç­‰ç­‰ï¼Œ
å®ƒå€‘éƒ½æ˜¯å°‡è³‡æ–™è½‰æ›æˆå¦ä¸€ç¨®è³‡æ–™çš„è¦å‰‡ï¼Œä¸”å…·å‚™ä¸åŒçš„ç”¨é€”ã€‚

### ç‚ºä»€éº¼è¦ç·¨ç¢¼ï¼Ÿ

èˆ‰å€‹ä¾‹å­ï¼Œæˆ‘å€‘çš„é›»è…¦æ˜¯ä»¥äºŒé€²ä½çš„æ–¹å¼å„²å­˜è³‡æ–™çš„ï¼Œ
ä¹Ÿå°±æ˜¯èªªï¼Œæˆ‘å€‘çš„é›»è…¦åªèƒ½å„²å­˜ `0` è·Ÿ `1`ï¼Œ
æ‰€ä»¥ç•¶æˆ‘å€‘è¦å„²å­˜ä¸€å€‹å­—å…ƒæ™‚ï¼Œæˆ‘å€‘å¿…é ˆå°‡é€™å€‹å­—å…ƒè½‰æ›æˆäºŒé€²ä½çš„è³‡æ–™ï¼Œ
ä¸”è½‰æ›å¿…é ˆæ˜¯å¯ä»¥è¢«åè½‰çš„ï¼Œé€™æ¨£æˆ‘å€‘æ‰èƒ½å°‡é€™å€‹äºŒé€²ä½çš„è³‡æ–™è½‰æ›å›å­—å…ƒã€‚

è«¸å¦‚æ­¤é¡å› ç‚ºå„²å­˜è³‡æ–™çš„æ–¹å¼ä¸åŒï¼Œæ‰€ä»¥å¿…é ˆè¦è½‰æ›çš„æƒ…æ³ï¼Œ
å°±æœƒéœ€è¦ç·¨ç¢¼ä¾†å¹«åŠ©æˆ‘å€‘å°‡è³‡æ–™è½‰æ›æˆå¦ä¸€ç¨®è³‡æ–™ã€‚

é€™é‚Šæˆ‘å€‘ä¹Ÿå¯ä»¥ç™¼ç¾åˆ°è³‡æ–™è½‰æ›èƒ½å¤ æˆç«‹çš„æ¢ä»¶ï¼Œ
æ˜¯å¿…é ˆè¦åŸºæ–¼å…±åŒçš„è¦å‰‡ï¼Œä¾‹å¦‚å‰é¢æåˆ°çš„å­—æ¯å°æ‡‰è¡¨ï¼Œ
é€™æ¨£æˆ‘å€‘æ‰èƒ½å°‡è³‡æ–™è½‰æ›å›ä¾†ï¼Œä¹Ÿæ‰èƒ½é€²è€Œå°‡è³‡æ–™ç”¨æ–¼å„²å­˜æˆ–æºé€šã€‚

> æ‰€ä»¥å¦‚æœæœ‰äººèªªä»–çš„æª”æ¡ˆç·¨ç¢¼è·‘æ‰ (æˆ–æ˜¯èªª å‡ºç¾äº‚ç¢¼ ä¹‹é¡çš„)ï¼Œ
> é‚£å…¶å¯¦å°±æ˜¯æŒ‡ä»–ç”¨äº†è·Ÿä½ ç•¶åˆæ’°å¯«æ™‚ä¸åŒçš„ç·¨ç¢¼ (å­—æ¯å°æ‡‰è¡¨) ä¾†é–‹å•Ÿæª”æ¡ˆã€‚

### ç·¨ç¢¼é©ç”¨æ–¼ä»»ä½•è³‡æ–™

é›–ç„¶ä¸Šé¢èˆ‰äº†æ–‡å­—çš„ä¾‹å­ï¼Œä½†æ˜¯ç·¨ç¢¼é€™å€‹æ¦‚å¿µé©ç”¨åœ¨ä»»ä½•è³‡æ–™ä¸Šï¼Œ
ä¾‹å¦‚. åœ–ç‰‡ã€å½±ç‰‡ã€éŸ³æ¨‚ã€æª”æ¡ˆç­‰ç­‰ã€‚

ä»»ä½•ç‰½æ¶‰åˆ°è³‡æ–™è½‰æ›çš„éç¨‹ï¼Œéƒ½ç¨±ä¹‹ç‚ºç·¨ç¢¼ï¼Œ
æ‰€ä»¥ä¸ç”¨å¤ªç–‘æƒ‘ç‚ºä»€éº¼è™•ç†åœ–åƒæˆ–å½±ç‰‡çš„å‡½å¼åº«æœƒå‡ºç¾ encode æˆ– decode ä¹‹é¡çš„å‡½å¼ï¼Œ
ä¾‹å¦‚. [go-image-jpeg][go-image-jpeg]ï¼Œ[rust-video][rust-video]ã€‚

[go-image-jpeg]: https://pkg.go.dev/image/jpeg
[rust-video]: https://docs.rs/video-rs/latest/video_rs/

## Base64 æ˜¯ä»€éº¼ï¼Ÿ

`base64` æ˜¯ä¸€ç¨®å°‡äºŒé€²ä½è³‡æ–™ç·¨ç¢¼æˆ [ASCII][ascii] å­—å…ƒçš„ç·¨ç¢¼æ–¹å¼ï¼Œ
å®ƒçš„åç¨±ä¾†è‡ªæ–¼å®ƒçš„ç·¨ç¢¼å­—å…ƒè¡¨ã€‚

é›–ç„¶ `base64` çš„åç¨±æ˜¯ `base64`ï¼Œä½†æ˜¯å®ƒçš„ç·¨ç¢¼å­—å…ƒè¡¨æœ‰ 65 å€‹å­—å…ƒï¼Œ
`=` æ˜¯ pending å­—å…ƒï¼Œå®ƒçš„ç”¨é€”æ˜¯ç”¨ä¾†å¡«è£œè³‡æ–™é•·åº¦ä¸è¶³çš„æƒ…æ³ã€‚

```text
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
```

è©³ç´°çš„å°ç…§è¡¨å¯ä»¥åƒè€ƒ[é€™è£¡][base64-table]ã€‚

[base64-table]: https://datatracker.ietf.org/doc/html/rfc4648#:~:text=Table%201%3A%20The%20Base%2064%20Alphabet

å®ƒè¢«è¨­è¨ˆå‡ºä¾†çš„åŸå› ï¼Œå°±æ˜¯æƒ³é€éæ–‡å­—çš„æ–¹å¼ä¾†å‘ˆç¾äºŒé€²ä½è³‡æ–™ï¼Œ
ç•¢ç«Ÿä¸¦ä¸æ˜¯æ‰€æœ‰çš„åœ°æ–¹éƒ½èƒ½å¤ ç›´æ¥å„²å­˜äºŒé€²ä½è³‡æ–™ï¼Œ
ä¾‹å¦‚. HTMLã€JSONï¼Œé€™äº›æª”æ¡ˆæ ¼å¼ä¸¦æ²’è¾¦æ³•ç›´æ¥å„²å­˜äºŒé€²ä½è³‡æ–™ï¼Œ
æ‰€ä»¥æ‰æœƒéœ€è¦é€é `Base64` é€éæ–‡å­—çš„æ–¹å¼ä¾†å„²å­˜äºŒé€²ä½è³‡æ–™ã€‚

äºŒé€²ä½è³‡æ–™å°±æ˜¯ `0` è·Ÿ `1` è€Œå·²ã€‚
æ­£å¸¸ä¸æœƒç›´æ¥å»çœ‹ `0` è·Ÿ `1` ä¾†ç†è§£è³‡è¨Šï¼Œ[å®ƒä¸€é–‹å§‹å°±ä¸æ˜¯è¦è¨­è¨ˆä¾†çµ¦äººçœ‹çš„][not-human-readable]ã€‚

### Base64 çš„æ‡‰ç”¨å ´æ™¯

`base64` é€šå¸¸ç”¨ä¾†è§£æ±ºå„²å­˜æˆ–æ˜¯å‚³è¼¸æ™‚ï¼Œ
åªèƒ½ä½¿ç”¨ ASCII å­—å…ƒ (åŒ…å«å®ƒçš„è¶…é›† UTF-8) é€™é¡ç„¡æ³•æ¥å—ä»»æ„äºŒé€²ä½è³‡æ–™çš„æƒ…æ³ï¼Œ
å·²ç¢ºä¿è³‡æ–™åœ¨å‚³è¼¸æˆ–å„²å­˜çš„éç¨‹ä¸­ä¿æŒè³‡è¨Šçš„å®Œæ•´è€Œä¸æœƒè¢«ç ´å£ã€‚

èˆ‰å€‹ä¾‹å­ï¼Œ
HTML æ˜¯ç´”æ–‡æœ¬çš„æª”æ¡ˆé¡å‹ï¼Œæ‰€ä»¥æˆ‘å€‘ç„¡æ³•ç›´æ¥åµŒå…¥äºŒé€²ä½è³‡æ–™ï¼Œ
ä½†æ˜¯é€é `base64` æˆ‘å€‘å¯ä»¥å°‡äºŒé€²ä½è³‡æ–™è½‰æ›æˆæ–‡å­—ï¼Œ
æ­é… [`data:`URL][data-url] ä¾†ç›´æ¥åµŒå…¥äºŒé€²ä½è³‡æ–™ã€‚

[data-url]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs

```html
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIA..." />
```

### Base64 ä¸æ˜¯åŠ å¯†æ³•

é€™æ˜¯ä¸€å€‹å¾ˆå¸¸è¦‹ä¹Ÿå¸¸è¢«èª¤è§£çš„å•é¡Œï¼Œ

**åŠ å¯†**æ˜¯ç‚ºäº†ä¿å¯†è€Œå°è³‡è¨Šé€²è¡Œè½‰æ›çš„éç¨‹ï¼Œæ‰€ä»¥å®ƒä¹Ÿå±¬æ–¼ç·¨ç¢¼çš„ä¸€ç¨®ï¼Œ
ä½†æ˜¯**ç·¨ç¢¼**ä¸ä¸€å®šæ˜¯ç‚ºäº†ä¿å¯†è€Œé€²è¡Œçš„ï¼Œ
ä¾‹å¦‚. `base64` ä¸¦ä¸æ˜¯ç‚ºäº†ä¿å¯†è€Œé€²è¡Œçš„ç·¨ç¢¼ï¼Œ
å®ƒåªæ˜¯åŸå°ä¸å‹•çš„å°‡äºŒé€²ä½è³‡æ–™è½‰æ›æˆ ASCII å­—å…ƒï¼Œ
æ‰€ä»¥ä½ å¯èƒ½ä¸æœƒå¸Œæœ›çœ‹åˆ° `base64` é€™ç¨®ç·¨ç¢¼æ–¹å¼è¢«ç”¨åœ¨åŠ å¯†ä¸Šã€‚

> å¦‚æœä½ æ˜¯æƒ³è¨­è¨ˆä¸€å¼µåªæœ‰ä½ è·Ÿä½ çš„æœ‹å‹å€‘æ‰èƒ½çœ‹æ‡‚çš„å­—æ¯å°æ‡‰è¡¨ï¼Œ
> é€™ç¨®æ–¹å¼å«åš [å‡±è–©åŠ å¯†æ³• (Caesar cipher)][caesar_cipher]ã€‚

[caesar_cipher]: https://en.wikipedia.org/wiki/Caesar_cipher

### Base64 çš„è®Šé«” base64url

`base64` æœ‰ä¸€å€‹è®Šé«”å«åš `base64url`ï¼Œ
å®ƒæ˜¯ç‚ºäº†è®“ `base64` å¯ä»¥ç”¨æ–¼ URL æˆ–æ˜¯ æª”æ¡ˆåç¨± è€Œè¨­è¨ˆçš„ã€‚

å› ç‚º `base64` æœƒä½¿ç”¨ `+` è·Ÿ `/` é€™å…©å€‹å­—å…ƒï¼Œ
è€Œé€™å…©å€‹å­—å…ƒåœ¨ URL ä¸­æœ‰ç‰¹æ®Šçš„æ„ç¾©ï¼Œ
æ‰€ä»¥ `base64url` å°‡ `+` è·Ÿ `/` åˆ†åˆ¥æ›¿æ›æˆ `-` è·Ÿ `_`ã€‚

```text
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=
```

è©³ç´°çš„å°ç…§è¡¨å¯ä»¥åƒè€ƒ[é€™è£¡][base64url-table]ã€‚

[base64url-table]: https://datatracker.ietf.org/doc/html/rfc4648#:~:text=Table%202%3A%20The%20%22URL%20and%20Filename%20safe%22%20Base%2064%20Alphabet

### Base64 æœƒå¢åŠ è³‡æ–™çš„å¤§å°

å¸¸è¦‹çš„èª¤è§£èªç‚º `base64` å¯ä»¥å°‡è³‡æ–™å£“ç¸®ï¼Œ
ä½†æ˜¯äº‹å¯¦ä¸Šï¼Œ`base64` æœƒå¢åŠ è³‡æ–™çš„å¤§å°ã€‚

æ ¹æ“š [RFC 4648][rfc-4648]ï¼Œ
ä¸€å€‹ `base64` å­—å…ƒåªèƒ½æ›¿ä»£åŸå§‹è³‡æ–™çš„ 6 å€‹ä½å…ƒï¼Œ
è€Œä¸€å€‹ `base64` å­—å…ƒæ˜¯ç”± 8 å€‹ä½å…ƒçµ„æˆçš„ã€‚

æ‰€ä»¥ï¼Œå‡è¨­æˆ‘å€‘æœ‰ç­†è³‡æ–™é•·åº¦ç‚º 3 å€‹ bytes `(3x8 bits = 24 bits)`ï¼Œ
`base64` å°±æœƒå°‡è³‡æ–™æ‹†åˆ†æˆ 4 å€‹ 6-bit ç‚ºä¸€çµ„ `(4x6 bits = 24 bits)`ï¼Œ
è€Œä¸€å€‹å­—å…ƒæ˜¯ç”± 8 å€‹ä½å…ƒçµ„æˆçš„ `(4x8 bits = 32 bits)`ï¼Œ
`32 / 24 = 1.333`ï¼Œ
ä¹Ÿå°±æ˜¯èªª `base64` å¤§æ¦‚æœƒå¢åŠ  33.3% çš„è³‡æ–™å¤§å° (a.k.a å¤§æ¦‚å¤§äº† `1/3`)ã€‚

> ç„¡è«–ä»»ä½•è³‡æ–™å½¢å¼ï¼Œéƒ½æ˜¯ç”±äºŒé€²ä½è³‡æ–™çµ„æˆçš„ï¼Œè¨ˆç®—å¤§å°çš„å–®ä½éƒ½æ˜¯ä½å…ƒ (bits)ï¼Œ
> ä¸€å€‹ bit åªèƒ½å„²å­˜ `0` æˆ– `1`ã€‚

### Base64 å¯ä»¥å»é™¤ä¸å¯è¦–å­—å…ƒ

é€™å€‹èªªæ³•å…¶å¯¦æœ‰é»ç± çµ±ä¸”å€’æœç‚ºå› äº†ï¼Œ
æ‡‰è©²èªªå®ƒåœ¨è¨­è¨ˆéšæ®µå°±åˆ»æ„é¿é–‹äº†éè‹±æ–‡å–®å­— (Non-Alphabet) çš„å­—å…ƒã€‚

## JavaScript ä¸­çš„ Base64

### [btoa] è·Ÿ [atob]

åœ¨ JavaScript ä¸­ï¼Œæˆ‘å€‘å¯ä»¥é€é [btoa] è·Ÿ [atob] ä¾†é€²è¡Œ `base64` çš„ encode è·Ÿ decodeã€‚

[btoa] å°±æ˜¯ `binary to ascii` çš„ç¸®å¯«ï¼Œ
ç”¨ä¾†å°‡äºŒé€²ä½æ–‡å­—è³‡æ–™è½‰æ›æˆ `base64` çš„æ–‡å­—è³‡æ–™ã€‚

[atob] å°±æ˜¯ `ascii to binary` çš„ç¸®å¯«ï¼Œ
å°±æ˜¯ç”¨ä¾†å°‡ `base64` çš„æ–‡å­—è³‡æ–™è½‰æ›å›äºŒé€²ä½æ–‡å­—è³‡æ–™ã€‚

> é€™é‚Šçš„äºŒé€²ä½æ–‡å­—è³‡æ–™å…¶å¯¦å°±æ˜¯æˆ‘å€‘åœ¨ç¨‹å¼è£¡é¢å¸¸ç”¨çš„ [string]ã€‚

ä½†é€™å…©å€‹å‡½å¼å…¶å¯¦ä¸¦æ²’æœ‰è¾¦æ³•å®Œå…¨å°‡ä»»æ„çš„äºŒé€²ä½è³‡æ–™è½‰æ›æˆ `base64`ï¼Œ
ä»–å€‘èƒ½è™•ç†çš„åªæœ‰ `0x00` åˆ° `0xFF` é€™å€‹ç¯„åœè€Œå·²ï¼Œ
ç•¶å‡ºç¾è¶…éé€™å€‹ç¯„åœçš„äºŒé€²ä½è³‡æ–™å°±æœƒæ‹‹å‡º [InvalidCharacterError][invalidcharactererror]ã€‚

> é€™å…©å€‹å‡½å¼ä¸¦æ²’æœ‰æ”¯æ´è½‰æ›ä»»æ„äºŒé€²ä½è³‡æ–™çš„åŸå› æ˜¯
> å› ç‚ºä»–å€‘èª•ç”Ÿçš„æ¯” web å¹³å°æ”¯æ´äºŒé€²åˆ¶è³‡æ–™å‹åˆ¥çš„æ™‚é–“é‚„æ—©ï¼Œ
> æ—©æœŸä¸¦æ²’æœ‰äººè¦ºå¾— web å¹³å°éœ€è¦æ”¯æ´äºŒé€²åˆ¶è³‡æ–™å‹åˆ¥ã€‚

> å› ç‚ºç•¶åˆçš„è¨­è¨ˆï¼Œåªèƒ½å¤ è™•ç† 0x00 åˆ° 0xFF é€™å€‹ç¯„åœçš„äºŒé€²ä½è³‡æ–™ï¼Œ
> æ‰€ä»¥æœ‰äº›äººä»¥ç‚º `base64` æ˜¯ä¸€ç¨®æ–‡å­—ç·¨ç¢¼ï¼Œ
> ä½†æ˜¯ `base64` æ˜¯é‡å°äºŒé€²ä½è³‡æ–™çš„ç·¨ç¢¼ï¼Œè€Œä¸æ˜¯é‡å°æ–‡å­—ç·¨ç¢¼ï¼Œ
> [ASCII][ascii]ï¼Œ[UTF-8][utf-8] é€™äº›æ‰æ˜¯é‡å°æ–‡å­—çš„ç·¨ç¢¼ã€‚

èˆ‰å€‹ä¾‹å­ï¼Œ

```js
btoa("ğŸ¦„");
// Uncaught DOMException: Failed to execute 'btoa' on 'Window':
// The string to be encoded contains characters outside of the Latin1 range.
```

é€™é‚Šçš„ `ğŸ¦„` å°±æ˜¯è¶…éäº† `0xFF` çš„ç¯„åœï¼Œ
åœ¨ç¾ä»Šå¤§éƒ¨åˆ†å¹³å°éƒ½æ”¯æ´ [UTF-8][utf-8] é€™å€‹ç¯„åœå­—å…ƒé›†çš„æƒ…æ³ä¸‹ï¼Œ
ä½¿ç”¨ [btoa] è·Ÿ [atob] ä¾†é€²è¡Œ `base64` çš„ encode è·Ÿ decode å…¶å¯¦ä¸¦ä¸æ˜¯å¾ˆç†æƒ³ã€‚

[btoa]: https://developer.mozilla.org/en-US/docs/Web/API/btoa
[atob]: https://developer.mozilla.org/en-US/docs/Web/API/atob
[string]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String
[invalidcharactererror]: https://developer.mozilla.org/en-US/docs/Web/API/btoa#invalidcharactererror

### [Encoding API][encoding-api]

[Encoding API][encoding-api] è¢«è¨­è¨ˆç”¨æ–¼è™•ç†å„ç¨®å­—å…ƒç·¨ç¢¼è½‰æ›ï¼ŒåŒ…æ‹¬ [UTF-8][utf-8] ç¯„åœå­—å…ƒé›†ï¼Œ
ä»¥ä¸‹ä»‹ç´¹ [Encoding API][encoding-api] ä¸­çš„ [TextEncoder][textencoder] è·Ÿ [TextDecoder][textdecoder]ã€‚

[TextEncoder][textencoder] ä¸»è¦ç”¨æ–¼å°‡æ–‡å­—è³‡æ–™è½‰æ›æˆäºŒé€²ä½è³‡æ–™ï¼Œ

```js
const encoder = new TextEncoder();
const encoded = encoder.encode("ğŸ¦„");
console.log(encoded);
// Uint8Array(4)Â [240, 159, 166, 132]
```

> [Uint8Array] æ˜¯ä¸€ç¨®å›ºå®šé•·åº¦çš„é™£åˆ—ï¼Œæ¯æ ¼ç”± 8 å€‹ä½å…ƒçµ„æˆçš„ï¼Œ
> æ˜¯ JavaScript è™•ç†äºŒé€²ä½è³‡æ–™çš„ä¸€ç¨®è³‡æ–™å‹åˆ¥ã€‚

[TextDecoder][textdecoder] å‰‡ç”¨æ–¼å°‡äºŒé€²ä½è³‡æ–™è½‰æ›æˆæ–‡å­—è³‡æ–™ï¼Œ

```js
const decoder = new TextDecoder();
const decoded = decoder.decode(new Uint8Array([240, 159, 166, 132]));
console.log(decoded);
// ğŸ¦„
```

ä¸Šé¢é›–ç„¶å¯ä»¥å°‡ [UTF-8][utf-8] ç¯„åœå­—å…ƒé›†çš„æ–‡å­—è³‡æ–™è½‰æ›æˆäºŒé€²ä½è³‡æ–™ï¼Œä½†æ˜¯é‚„ä¸æ˜¯ `base64`ã€‚
æˆ‘å€‘éœ€è¦æ­é… [btoa], [atob] è·Ÿ [String.fromCodePoint][fromcodepoint] ä¾†é€²è¡Œ `base64` çš„ encode è·Ÿ decodeã€‚

ç”¨ ğŸ¦„ èˆ‰å€‹ä¾‹å­ï¼Œæˆ‘å€‘è¦å°‡å…¶è½‰æ›æˆ base64ï¼Œæ•´å€‹è½‰æ›é‚è¼¯æ¼”ç®—å¦‚ä¸‹ï¼š

1. å°‡ [UTF-8][utf-8] å­—å…ƒè½‰æ›æˆäºŒé€²ä½ï¼Œè®“ ğŸ¦„ å±•ç¾åŸè²Œè®Šæˆ `Uint8Array(4)`ã€‚
   ( ğŸ¦„ => `Uint8Array(4)[240, 159, 166, 132]` )
   é€™æ™‚ï¼Œå–®çœ‹æ¯æ ¼è£é¢çš„æ•¸å€¼å·²è½åœ¨ `0x00` åˆ° `0xFF` çš„ç¯„åœäº†ã€‚
   (`Uint8` çš„ç¯„åœ 0 ~ 255 å°±æ˜¯ `0x00` ~ `0xFF`)
2. å°‡æ¯æ ¼è£¡é¢çš„æ•¸å€¼æ‹†å‡ºä¾†ï¼Œå€‹åˆ¥è½‰æ›æˆæ–‡å­—ã€‚
   ( `Uint8Array(4)` => `[240, 159, 166, 132]` )
   ( `String.fromCodePoint(240)` => `Ã°` )
   ( `String.fromCodePoint(159)` => `\x9F` )
   ( `String.fromCodePoint(166)` => `Â¦` )
   ( `String.fromCodePoint(132)` => `\x84` )
3. å› ç‚ºåˆ†åˆ¥è½‰æ›çš„æ–‡å­—å·²ç¶“è½åœ¨ `0x00` åˆ° `0xFF` çš„ç¯„åœäº† (0 ~ 255)ï¼Œ
   æ‰€ä»¥å¯ä»¥é€é [btoa] ä¾†é€²è¡Œ `base64` çš„ encodeã€‚
   ( `btoa("Ã°\x9FÂ¦\x84")` => `8J+mhA==` )

```js
const encoder = new TextEncoder();
const encoded = encoder.encode("ğŸ¦„");
const binString = String.fromCodePoint(...encoded);
const base64 = btoa(binString);
console.log(base64);
// 8J+mhA==
```

åä¹‹ï¼Œè¦å°‡ base64 è½‰æ›å› ğŸ¦„ï¼Œæ•´å€‹è½‰æ›é‚è¼¯æ¼”ç®—å¦‚ä¸‹ï¼š

1. é€é [atob] å°‡ base64 è½‰æ›æˆå€‹åˆ¥æ–‡å­—ã€‚
   ( `atob('8J+mhA==')` => "Ã°\x9FÂ¦\x84" )
2. å°‡å€‹åˆ¥æ–‡å­—è³‡æ–™è½‰æ›æˆ `Uint8Array(4)`ã€‚
   ( "Ã°\x9FÂ¦\x84" => `Uint8Array(4)[240, 159, 166, 132]` )
3. å†å°‡ `Uint8Array(4)` é€é [TextDecoder] è½‰æ›æˆ ğŸ¦„ã€‚
   ( `Uint8Array(4)[240, 159, 166, 132]` => ğŸ¦„ )

```js
const binString = atob("8J+mhA==");
const bytes = Uint8Array.from(binString, (char) => char.codePointAt(0));
const decoder = new TextDecoder();
const decoded = decoder.decode(bytes);
console.log(decoded);
// ğŸ¦„
```

åœ¨ç¾ä»Šå¤§éƒ¨åˆ†ç³»çµ±éƒ½æ”¯æ´ [UTF-8][utf-8] ç¯„åœå­—å…ƒé›†çš„æƒ…æ³ä¸‹ï¼Œ
åœ¨è™•ç†æ–‡å­—èˆ‡äºŒé€²ä½è³‡æ–™è½‰æ›çš„æ™‚å€™ï¼Œ
ä½¿ç”¨ä¸Šè¿°æ–¹æ³•ä¾†é€²è¡Œ `base64` çš„ encode è·Ÿ decode æœƒæ¯” [btoa] è·Ÿ [atob] æ›´ç†æƒ³ã€‚

## Node.js çš„ [Buffer]

åœ¨ Node.jsï¼Œæš«æ™‚ç„¡æ³•ä½¿ç”¨ [Encoding API][encoding-api]ï¼Œ
ä½†æ˜¯ [Encoding API][encoding-api] æ˜¯ [WHATWG][whatwg-encoding] æå‡ºçš„æ¨™æº–è¦æ ¼ï¼Œ
åœ¨æœªä¾†æ‡‰è©²æœƒè¢« Node.js æ”¯æ´ã€‚ (æ­¤æ–‡ç« ç™¼å¸ƒæ™‚ï¼ŒNode.js LTS v18.18.0)

æ‰€ä»¥åœ¨ Node.js ä¸­ï¼Œæˆ‘å€‘å¯ä»¥é€é [Buffer] ä¾†é€²è¡Œ `base64` çš„ encode è·Ÿ decodeã€‚

```js
const encoded = Buffer.from("ğŸ¦„").toString("base64");
console.log(encoded);
// 8J+mhA==
```

```js
const decoded = Buffer.from("8J+mhA==", "base64").toString();
console.log(decoded);
// ğŸ¦„
```

## è½‰æ›ä»»æ„äºŒé€²åˆ¶è³‡æ–™

[rfc-4648]: https://tools.ietf.org/html/rfc4648#section-4
[not-human-readable]: https://datatracker.ietf.org/doc/html/rfc4648#:~:text=The%20Base%2064%20encoding%20is%20designed%20to%20represent%20arbitrary%20sequences%20of%0A%20%20%20octets%20in%20a%20form%20that%20allows%20the%20use%20of%20both%20upper%2D%20and%20lowercase%0A%20%20%20letters%20but%20that%20need%20not%20be%20human%20readable.
[Buffer]: https://nodejs.org/api/buffer.html
[whatwg-encoding]: https://encoding.spec.whatwg.org/
[encoding-api]: https://developer.mozilla.org/en-US/docs/Web/API/Encoding_API
[textencoder]: https://developer.mozilla.org/en-US/docs/Web/API/TextEncoder
[textdecoder]: https://developer.mozilla.org/en-US/docs/Web/API/TextDecoder
[Uint8Array]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array
[utf-8]: https://zh.wikipedia.org/wiki/UTF-8
[ascii]: https://zh.wikipedia.org/wiki/ASCII
[fromcodepoint]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCodePoint
